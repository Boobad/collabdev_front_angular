<div class="projects-container">
  <div class="center-wrapper">
    
    <!-- Message de chargement -->
    <div *ngIf="isLoading" class="loading-message fade-in">
      <mat-icon class="loading-icon spin">sync</mat-icon>
      <p>Chargement des projets en attente...</p>
    </div>

    <!-- Message d'erreur -->
    <div *ngIf="error" class="error-message bounce-in">
      <mat-icon>error_outline</mat-icon>
      <p>{{ error }}</p>
      <button mat-raised-button color="warn" (click)="fetchProjects()">
        <mat-icon>refresh</mat-icon> Réessayer
      </button>
    </div>
  </div>

  <!-- Liste des projets -->
  <div *ngIf="!isLoading && !error" class="projects-grid">
    <div *ngFor="let project of filteredProjects" class="card">
      
      <!-- Catégorie et coins -->
      <div class="titres">
        <span class="category {{getDomainClass(project.domaine)}}">
          {{ project.domaine || 'N/A' }}
        </span>
        <span class="coins">
          <i class="fa fa-coins" style="margin-right: 6px;"></i>
          <span>{{ project.coinsRequired || 100 }}</span>
        </span>
      </div>

      <div class="divider"></div>

      <!-- Informations principales -->
      <div class="info">
        <h1>{{ project.titre || 'Pas de titre' }}</h1>
        <p class="description">
          {{ project.description || 'Pas de description disponible' }}
        </p>
      </div>

      <!-- Niveau et Statut séparés -->
      <div class="details">
        <div class="badge niveau" *ngIf="project.niveau">
          {{ project.niveau }}
        </div>
        <div class="badge secteur" *ngIf="project.secteur">
          {{ project.secteur }}
        </div>
        <div class="badge statut" [ngClass]="project.status.toLowerCase()">
          {{ project.status }}
        </div>
      </div>

      <div class="divider"></div>

      <!-- Bouton -->
      <div class="buttons">
        <button
  (click)="onProjectButtonClick(project.id, project.coinsRequired || 100)"
  [disabled]="isUserPendingParticipant(project.id)">
  {{ getProjectButtonLabel(project.id, project.coinsRequired || 100) }}
</button>

      </div>

    </div>

    <!-- Aucun projet -->
    <div *ngIf="filteredProjects.length === 0 && !isLoading && !error" class="no-projects">
      <mat-icon>info_outline</mat-icon>
      <p>Aucun projet en attente disponible</p>
    </div>
  </div>
</div>
